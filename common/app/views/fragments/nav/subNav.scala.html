@(page: model.Page, isFooter: Boolean = false)(implicit request: RequestHeader)

@import common.{ Edition, LinkTo }
@import navigation.{ NavigationHelpers, NavLink2 }
@import views.support.RenderClasses

@* TODO: Move logic to hide after 5 sections(?) on Mobile in CSS *@
@subNavItem(link: NavLink2, id: String) = {
    <li class="subnav__item">
        <a class="@RenderClasses(Map(
                "subnav-link" -> true,
                "subnav-link--current-section" -> (id == link.id)
            ))"
            href="@LinkTo(link.url)"
            data-link-name="nav2 : subnav : @{link.title}">

            @link.title
        </a>
    </li>
}

@defining(NavigationHelpers.getSubNav(page)) { maybeNavItem =>
    @maybeNavItem.map { navItem =>

        <div class="subnav">
            <div class="gs-container">
                <ul class="subnav__list"
                    data-pillar-title="@navItem.pillar.title">

                    @defining(
                        NavigationHelpers.getSectionsToDisplay(navItem, Edition(request))
                    ) { sections =>
                        @sections.map { link => @subNavItem(link, navItem.id)}
                    }

                @* Hiding the 'more' link on the homepage and footer *@
                @if(!(navItem.id == "uk" ||  navItem.id == "us" ||  navItem.id == "au" ||  navItem.id == "international" || isFooter)) {
                    <li class="subnav__item js-visible hide-on-desktop">
                        <button class="
                            subnav-link
                            subnav-link--toggle-more
                            js-toggle-nav-section"
                            data-link-name="nav2 : subnav-toggle">
                            more
                        </button>
                    </li>
                }
                </ul>

            </div>
        </div>
    }
}
